<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<link rel="stylesheet" href="style.css" type="text/css">
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<link rel="Start" href="index.html">
<link rel="previous" href="Pvem_lwt_unix.IO.html">
<link rel="next" href="Pvem_lwt_unix.DEFERRED_LIST.html">
<link rel="Up" href="Pvem_lwt_unix.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="Index of module types" rel=Appendix href="index_module_types.html">
<link title="Pvem_lwt_unix" rel="Chapter" href="Pvem_lwt_unix.html"><title>Pvem_lwt_unix.SYSTEM</title>
</head>
<body>
<div class="navbar"><a class="pre" href="Pvem_lwt_unix.IO.html" title="Pvem_lwt_unix.IO">Previous</a>
&nbsp;<a class="up" href="Pvem_lwt_unix.html" title="Pvem_lwt_unix">Up</a>
&nbsp;<a class="post" href="Pvem_lwt_unix.DEFERRED_LIST.html" title="Pvem_lwt_unix.DEFERRED_LIST">Next</a>
</div>
<h1>Module type <a href="type_Pvem_lwt_unix.SYSTEM.html">Pvem_lwt_unix.SYSTEM</a></h1>

<pre><span class="keyword">module type</span> SYSTEM = <code class="code"><span class="keyword">sig</span></code> <a href="Pvem_lwt_unix.SYSTEM.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><hr width="100%">

<pre><span id="VALsleep"><span class="keyword">val</span> sleep</span> : <code class="type">float -><br>       (unit, [> `System of [> `Sleep of float ] * [> `Exn of exn ] ])<br>       Pvem_lwt_unix.Deferred_result.t</code></pre><div class="info ">
Block for a given amount of seconds (<code class="code"><span class="constructor">Lwt_unix</span>.sleep</code>).<br>
</div>

<pre><span class="keyword">module</span> <a href="Pvem_lwt_unix.SYSTEM.Shell.html">Shell</a>: <code class="code"><span class="keyword">sig</span></code> <a href="Pvem_lwt_unix.SYSTEM.Shell.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info">
Manipulate <code class="code">/bin/sh</code> commands (flavors of <code class="code"><span class="constructor">Unix</span>.system</code>).
</div>

<pre><span id="VALwith_timeout"><span class="keyword">val</span> with_timeout</span> : <code class="type">float -><br>       f:(unit -><br>          ('a,<br>           [> `System of [> `With_timeout of float ] * [> `Exn of exn ]<br>            | `Timeout of float ]<br>           as 'error)<br>          Pvem_lwt_unix.Deferred_result.t) -><br>       ('a, 'error) Pvem_lwt_unix.Deferred_result.t</code></pre><div class="info ">
Execute a function <code class="code">f</code> with a timeout (in seconds). If <code class="code">f</code> throws
      an exception it will be passed as <code class="code"><span class="keywordsign">`</span><span class="constructor">System</span> (_, e)</code>, if the functions
      timeouts the error will be <code class="code"><span class="keywordsign">`</span><span class="constructor">Timeout</span> time</code>.<br>
</div>

<pre><span id="VALmake_new_directory"><span class="keyword">val</span> make_new_directory</span> : <code class="type">?perm:int -><br>       string -><br>       (unit,<br>        [> `System of<br>             [> `Make_directory of string ] *<br>             [> `Already_exists | `Exn of exn | `Wrong_access_rights of int ] ])<br>       Pvem_lwt_unix.Deferred_result.t</code></pre><div class="info ">
Create a new empty directory or fail if it already exists
      (i.e. like <code class="code">mkdir</code>). The default permissions are <code class="code">0o700</code>.<br>
</div>

<pre><span id="VALensure_directory_path"><span class="keyword">val</span> ensure_directory_path</span> : <code class="type">?perm:int -><br>       string -><br>       (unit,<br>        [> `System of<br>             [> `Make_directory of string ] *<br>             [> `Exn of exn | `Wrong_access_rights of int ] ])<br>       Pvem_lwt_unix.Deferred_result.t</code></pre><div class="info ">
Create as many directories as needed (can be 0) to ensure that the
      directory path exists (like <code class="code">mkdir -p</code>). The default permissions
      are <code class="code">0o700</code>.<br>
</div>

<pre><span id="TYPEfile_info"><span class="keyword">type</span> <code class="type"></code>file_info</span> = <code class="type">[ `Absent<br>       | `Block_device<br>       | `Character_device<br>       | `Directory<br>       | `Fifo<br>       | `Regular_file of int<br>       | `Socket<br>       | `Symlink of string ]</code> </pre>
<div class="info ">
Quick information on files.<br>
</div>


<pre><span id="VALfile_info_to_string"><span class="keyword">val</span> file_info_to_string</span> : <code class="type"><a href="Pvem_lwt_unix.SYSTEM.html#TYPEfile_info">file_info</a> -> string</code></pre><div class="info ">
Convert file information to a string<br>
</div>

<pre><span id="VALfile_info"><span class="keyword">val</span> file_info</span> : <code class="type">?follow_symlink:bool -><br>       string -><br>       (<a href="Pvem_lwt_unix.SYSTEM.html#TYPEfile_info">file_info</a>,<br>        [> `System of [> `File_info of string ] * [> `Exn of exn ] ])<br>       Pvem_lwt_unix.Deferred_result.t</code></pre><div class="info ">
Get information about a path (whether it exists, its size, or
      sym-link destination). If <code class="code">follow_symlink</code> is <code class="code"><span class="keyword">false</span></code>
      (default) use <code class="code">lstat</code> (so the result can be <code class="code"><span class="keywordsign">`</span><span class="constructor">Symlink</span> _</code>), if <code class="code"><span class="keyword">true</span></code>
      call <code class="code">stat</code> (information about the target).<br>
</div>

<pre><span id="VALlist_directory"><span class="keyword">val</span> list_directory</span> : <code class="type">string -><br>       [ `Stream of<br>           unit -><br>           (string option,<br>            [> `System of [> `List_directory of string ] * [> `Exn of exn ] ])<br>           Pvem_lwt_unix.Deferred_result.t ]</code></pre><div class="info ">
Get all the children of a directory, through a <code class="code">next</code> stream-like
      function.<br>
</div>

<pre><span id="VALremove"><span class="keyword">val</span> remove</span> : <code class="type">string -><br>       (unit,<br>        [> `System of<br>             [> `File_info of string | `List_directory of string | `Remove of string ] *<br>             [> `Exn of exn ] ])<br>       Pvem_lwt_unix.Deferred_result.t</code></pre><div class="info ">
Remove a file or a directory recursively. <code class="code">remove</code> does not fail
      if the file does not exist.<br>
</div>

<pre><span id="VALmake_symlink"><span class="keyword">val</span> make_symlink</span> : <code class="type">target:string -><br>       link_path:string -><br>       (unit,<br>        [> `System of<br>             [> `Make_symlink of string * string ] *<br>             [> `Exn of exn | `File_exists of string ] ])<br>       Pvem_lwt_unix.Deferred_result.t</code></pre><div class="info ">
Make a symbolic link <code class="code">link_path</code> pointing at
      <code class="code">target</code>. <code class="code">make_symlink</code> fails if the file <code class="code">link_path</code> already
      exists.<br>
</div>

<pre><span id="TYPEfile_destination"><span class="keyword">type</span> <code class="type"></code>file_destination</span> = <code class="type">[ `Into of string | `Onto of string ]</code> </pre>
<div class="info ">
Specification of a “destination” for <code class="code">copy</code> and <code class="code">move</code>.<br>
</div>


<pre><span id="VALcopy"><span class="keyword">val</span> copy</span> : <code class="type">?ignore_strange:bool -><br>       ?symlinks:[ `Fail | `Follow | `Redo ] -><br>       ?buffer_size:int -><br>       ?if_exists:[ `Fail | `Overwrite | `Update ] -><br>       src:string -><br>       <a href="Pvem_lwt_unix.SYSTEM.html#TYPEfile_destination">file_destination</a> -><br>       (unit,<br>        [> `System of<br>             [> `Copy of string<br>              | `File_info of string<br>              | `List_directory of string<br>              | `Make_directory of string<br>              | `Make_symlink of string * string<br>              | `Remove of string ] *<br>             [> `Already_exists<br>              | `Exn of exn<br>              | `File_exists of string<br>              | `File_not_found of string<br>              | `IO of [> `File_exists of string | `Wrong_path of string ]<br>              | `Not_a_directory of string<br>              | `Wrong_access_rights of int<br>              | `Wrong_file_kind of<br>                  string *<br>                  [> `Block_device<br>                   | `Character_device<br>                   | `Fifo<br>                   | `Socket<br>                   | `Symlink of string ]<br>              | `Wrong_path of string ] ])<br>       Pvem_lwt_unix.Deferred_result.t</code></pre><div class="info ">
Copy files or directories (recursively).
<p>

      If <code class="code">ignore_strange</code> is true <code class="code">copy</code> won't fail on block/character
      devices, fifos or sockets (defaults to <code class="code"><span class="keyword">false</span></code>).
<p>

      The <code class="code">buffer_size</code> (default <code class="code">64_000</code>) is used both for reading and
      writing files.
<p>

      On can <code class="code"><span class="keywordsign">`</span><span class="constructor">Fail</span></code> on symbolic links, <code class="code"><span class="keywordsign">`</span><span class="constructor">Follow</span></code> them, or <code class="code"><span class="keywordsign">`</span><span class="constructor">Redo</span></code> a new
      symlink with the same target.<br>
</div>

<pre><span id="VALmove_in_same_device"><span class="keyword">val</span> move_in_same_device</span> : <code class="type">?if_exists:[ `Fail | `Overwrite | `Update ] -><br>       src:string -><br>       <a href="Pvem_lwt_unix.SYSTEM.html#TYPEfile_destination">file_destination</a> -><br>       ([ `Moved | `Must_copy ],<br>        [> `System of<br>             [> `File_info of string | `Move of string ] *<br>             [> `Exn of exn | `File_exists of string ] ])<br>       Pvem_lwt_unix.Deferred_result.t</code></pre><div class="info ">
Try to move <code class="code">src</code> to <code class="code">dest</code> using <code class="code"><span class="constructor">Lwt_unix</span>.rename</code>, if it works,
      return <code class="code"><span class="keywordsign">`</span><span class="constructor">Moved</span></code> if it does not work but <code class="code">copy</code> could work
      (i.e. both paths are not in the same <i>device</i>) return
      <code class="code"><span class="keywordsign">`</span><span class="constructor">Must_copy</span></code>.<br>
</div>

<pre><span id="VALmove"><span class="keyword">val</span> move</span> : <code class="type">?ignore_strange:bool -><br>       ?symlinks:[ `Fail | `Follow | `Redo ] -><br>       ?buffer_size:int -><br>       ?if_exists:[ `Fail | `Overwrite | `Update ] -><br>       src:string -><br>       <a href="Pvem_lwt_unix.SYSTEM.html#TYPEfile_destination">file_destination</a> -><br>       (unit,<br>        [> `System of<br>             [> `Copy of string<br>              | `File_info of string<br>              | `List_directory of string<br>              | `Make_directory of string<br>              | `Make_symlink of string * string<br>              | `Move of string<br>              | `Remove of string ] *<br>             [> `Already_exists<br>              | `Exn of exn<br>              | `File_exists of string<br>              | `File_not_found of string<br>              | `IO of [> `File_exists of string | `Wrong_path of string ]<br>              | `Not_a_directory of string<br>              | `Wrong_access_rights of int<br>              | `Wrong_file_kind of<br>                  string *<br>                  [> `Block_device<br>                   | `Character_device<br>                   | `Fifo<br>                   | `Socket<br>                   | `Symlink of string ]<br>              | `Wrong_path of string ] ])<br>       Pvem_lwt_unix.Deferred_result.t</code></pre><div class="info ">
Heavy-weight function trying to mimic the behavior the UNIX command “mv”
      (c.f. <a href="http://www.openbsd.org/cgi-bin/cvsweb/src/bin/mv/mv.c?rev=1.35;content-type=text%2Fplain;only_with_tag=HEAD">mv.c</a>):
      it tries <code class="code">move_in_same_device</code> and if it returns <code class="code"><span class="keywordsign">`</span><span class="constructor">Must_copy</span></code> it
      calls <code class="code">copy</code> and <code class="code">remove</code> (if <code class="code">copy</code> fails, the <code class="code">remove</code> won't
      happen but there will be no clean-up of the files already
      copied).<br>
</div>

<pre><span id="TYPEfile_tree"><span class="keyword">type</span> <code class="type"></code>file_tree</span> = <code class="type">[ `Leaf of string * <a href="Pvem_lwt_unix.SYSTEM.html#TYPEfile_info">file_info</a><br>       | `Node of string * <a href="Pvem_lwt_unix.SYSTEM.html#TYPEfile_tree">file_tree</a> list ]</code> </pre>
<div class="info ">
Representation of a hierarchy of files (<code class="code"><span class="keywordsign">`</span><span class="constructor">Leaf</span></code>) and directories (<code class="code"><span class="keywordsign">`</span><span class="constructor">Node</span></code>).<br>
</div>


<pre><span id="VALfile_tree"><span class="keyword">val</span> file_tree</span> : <code class="type">?follow_symlinks:bool -><br>       string -><br>       (<a href="Pvem_lwt_unix.SYSTEM.html#TYPEfile_tree">file_tree</a>,<br>        [> `System of<br>             [> `File_info of string<br>              | `File_tree of string<br>              | `List_directory of string ] *<br>             [> `Exn of exn | `File_not_found of string ] ])<br>       Pvem_lwt_unix.Deferred_result.t</code></pre><div class="info ">
Obtain the <code class="code">file_tree</code> starting at a given path.<br>
</div>

<pre><span id="VALerror_to_string"><span class="keyword">val</span> error_to_string</span> : <code class="type">[< `Shell of<br>            string *<br>            [< `Exited of int | `Exn of exn | `Signaled of int | `Stopped of int ]<br>        | `System of<br>            [< `Copy of string<br>             | `File_info of string<br>             | `File_tree of string<br>             | `List_directory of string<br>             | `Make_directory of string<br>             | `Make_symlink of string * string<br>             | `Move of string<br>             | `Remove of string ] *<br>            [< `Already_exists<br>             | `Exn of exn<br>             | `File_exists of string<br>             | `File_not_found of string<br>             | `IO of<br>                 [< `Exn of exn<br>                  | `File_exists of string<br>                  | `Read_file_exn of string * exn<br>                  | `Write_file_exn of string * exn<br>                  | `Wrong_path of string ]<br>             | `Not_a_directory of string<br>             | `Wrong_access_rights of int<br>             | `Wrong_file_kind of string * <a href="Pvem_lwt_unix.SYSTEM.html#TYPEfile_info">file_info</a><br>             | `Wrong_path of string ] ] -><br>       string</code></pre><div class="info ">
Make a human-readable string for any error in this module.<br>
</div>
</body></html>