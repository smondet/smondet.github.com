 <!DOCTYPE html> <html> <head><link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootswatch/3.2.0/readable/bootstrap.min.css" type="text/css">
<link rel="stylesheet" href="https://cdn.rawgit.com/hammerlab/ketrew/2d1c430cca52caa71e363a765ff8775a6ae14ba9/src/doc/code_style.css" type="text/css"><meta charset="utf-8"><title>Ketrew: Long-Running Plugins</title></head><body><div class="container"><h1>Ketrew: Long-Running Plugins</h1><div class="row">
<div class="col-md-3">
<h2>Contents</h2><ul>
 <li><a href='#Implementation'>Implementation</a>
 </li>
 <li><a href='#Examples'>Examples</a>
 </li>
 <li><a href='#Alternative'>Alternative</a>
 </li>
</ul>
<h2>Menu</h2><ul>
 <li><a href='index.html'>Home</a></li>
 <li><a href='Alternative_CLI_Application.html'>Alternative CLI Application</a></li>
 <li><a href='Developer_Documentation.html'>Developer Documentation</a></li>
 <li><a href='Long-Running_Plugins.html'>Long-Running Plugins</a></li>
 <li><a href='Server_Commands.html'>Server Commands</a></li>
 <li><a href='The_Configuration_File.html'>The Configuration File</a></li>
 <li><a href='The_HTTP_API.html'>The HTTP API</a></li>
 <li><a href='Workflow_Examples.html'>Workflow Examples</a></li>
 <li><a href='dummy_plugin.html'>Plugin Example</a></li>
 <li><a href='dummy_plugin_user.html'>Plugin-Usage Example</a></li>
 <li><a href='integration.html'>Integration Test</a></li>
 <li><a href='main.html'>Main Test</a></li>
 <li><a href='preconfigured_main.html'>Preconfigured Main Example</a></li>
 <li><a href='./api/index.html'>API Documentation</a></li>
 <li>Repository <a href='https://github.com/hammerlab/ketrew'>at Github</a></li>
 <li>Up: <a href='../../index.html'>Software Projects</a></li>
</ul>
</div><div class="col-md-9"><h1 id="LongRunningProcessPlugins">Long-Running Process Plugins</h1>
<h2 id="Implementation">Implementation</h2>
<p>The long-running plugins <em>must</em>:</p>
<ul>
 <li>implement a module satisfying the <code>LONG_RUNNING</code> interface defined in
<a href='ketrew_long_running.html'><code>src/lib/ketrew_long_running.ml</code></a>
(with a <strong>unique</strong> <code>name</code>);</li>
 <li>provide a way to create values like
<code>`Long_running (name, serialized_state)</code>;</li>
 <li>register themselves with the function:
<a href='api/Ketrew_state.html#VALregister_long_running_plugin' title='Ketrew_state.register_long_running_plugin'><code>Ketrew_state.register_long_running_plugin</code></a>
(see the interface of <a href='api/Ketrew_state.html'><a href='api/Ketrew_state.html' title='Ketrew_state'><code>Ketrew_state</code></a></a>).</li>
</ul>

<h2 id="Examples">Examples</h2>
<p>There are (for now) two long-running methods in the library, see
<a href='api/Ketrew_lsf.html'><a href='api/Ketrew_lsf.html' title='Ketrew_lsf'><code>Ketrew_lsf</code></a></a> and
<a href='api/Ketrew_daemonize.html'><a href='api/Ketrew_daemonize.html' title='Ketrew_daemonize'><code>Ketrew_daemonize</code></a></a>.</p>
<p>And the tests contain a “dynamically linked plugin” that uses the
implementation of <a href='api/Ketrew_daemonize.html' title='Ketrew_daemonize'><code>Ketrew_daemonize</code></a> and adds a (stupid) custom runtime-query:</p>
<ul>
 <li>Implementation of the plugin:
<a href='dummy_plugin.html'><code>src/test/dummy_plugin.ml</code></a>.</li>
 <li>Workflow script that uses the plugin:
<a href='dummy_plugin_user.html'><code>src/test/dummy_plugin_user.ml</code></a>.</li>
</ul>

<h2 id="Alternative">Alternative</h2>
<p>Dynamic linking can be annoying: some libraries do not install <code>.cmxs</code> files,
some architectures do not support native dynlink, … Hopefully there is an
alternative, one can link plugins statically with <code>src/app/main.ml</code> (or another
version of that), see the
<a href='./Alternative_CLI_Application.html'>documentation</a>.</p>
</div></div></div></body><html>