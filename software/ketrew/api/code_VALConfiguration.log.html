<html><head>
<link rel="stylesheet" href="style.css" type="text/css">
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<link rel="Start" href="index.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of class methods" rel=Appendix href="index_methods.html">
<link title="Index of class types" rel=Appendix href="index_class_types.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="Index of module types" rel=Appendix href="index_module_types.html">
<link title="Client" rel="Chapter" href="Client.html">
<link title="Command_line" rel="Chapter" href="Command_line.html">
<link title="Configuration" rel="Chapter" href="Configuration.html">
<link title="Daemonize" rel="Chapter" href="Daemonize.html">
<link title="Document" rel="Chapter" href="Document.html">
<link title="EDSL" rel="Chapter" href="EDSL.html">
<link title="Engine" rel="Chapter" href="Engine.html">
<link title="Error" rel="Chapter" href="Error.html">
<link title="Eval_condition" rel="Chapter" href="Eval_condition.html">
<link title="Explorer" rel="Chapter" href="Explorer.html">
<link title="Host" rel="Chapter" href="Host.html">
<link title="Host_io" rel="Chapter" href="Host_io.html">
<link title="Interaction" rel="Chapter" href="Interaction.html">
<link title="Internal_pervasives" rel="Chapter" href="Internal_pervasives.html">
<link title="Long_running" rel="Chapter" href="Long_running.html">
<link title="Long_running_utilities" rel="Chapter" href="Long_running_utilities.html">
<link title="Lsf" rel="Chapter" href="Lsf.html">
<link title="Monitored_script" rel="Chapter" href="Monitored_script.html">
<link title="Path" rel="Chapter" href="Path.html">
<link title="Pbs" rel="Chapter" href="Pbs.html">
<link title="Persistent_data" rel="Chapter" href="Persistent_data.html">
<link title="Plugin" rel="Chapter" href="Plugin.html">
<link title="Program" rel="Chapter" href="Program.html">
<link title="Protocol" rel="Chapter" href="Protocol.html">
<link title="Server" rel="Chapter" href="Server.html">
<link title="Target" rel="Chapter" href="Target.html">
<link title="Unix_io" rel="Chapter" href="Unix_io.html">
<link title="Unix_process" rel="Chapter" href="Unix_process.html">
<link title="Yarn" rel="Chapter" href="Yarn.html"><title>Ketrew API : Configuration.log</title>
</head>
<body>
<code class="code"><span class="keyword">let</span>&nbsp;log&nbsp;t&nbsp;=<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;<span class="keyword">open</span>&nbsp;<span class="constructor">Log</span>&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;item&nbsp;name&nbsp;l&nbsp;=&nbsp;s&nbsp;name&nbsp;%&nbsp;s&nbsp;<span class="string">":&nbsp;"</span>&nbsp;%&nbsp;l&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;toplevel&nbsp;l&nbsp;=&nbsp;separate&nbsp;n&nbsp;l&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;sublist&nbsp;l&nbsp;=&nbsp;n&nbsp;%&nbsp;indent&nbsp;(separate&nbsp;n&nbsp;l)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;common&nbsp;=<br>
&nbsp;&nbsp;&nbsp;&nbsp;sublist&nbsp;[<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item&nbsp;<span class="string">"Debug-level"</span>&nbsp;(i&nbsp;t.debug_level);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item&nbsp;<span class="string">"Plugins"</span>&nbsp;(<span class="keyword">match</span>&nbsp;t.plugins&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;[]&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;s&nbsp;<span class="string">"None"</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;more&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;sublist&nbsp;(<span class="constructor">List</span>.map&nbsp;more&nbsp;~f:(<span class="keyword">function</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">Compiled</span>&nbsp;path&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;item&nbsp;<span class="string">"Compiled"</span>&nbsp;&nbsp;(quote&nbsp;path)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">OCamlfind</span>&nbsp;pack&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;item&nbsp;<span class="string">"OCamlfind&nbsp;package"</span>&nbsp;(quote&nbsp;pack))))<br>
&nbsp;&nbsp;&nbsp;&nbsp;]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ui&nbsp;t&nbsp;=<br>
&nbsp;&nbsp;&nbsp;&nbsp;sublist&nbsp;[<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item&nbsp;<span class="string">"Colors"</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="keyword">if</span>&nbsp;t.with_color&nbsp;<span class="keyword">then</span>&nbsp;s&nbsp;<span class="string">"with&nbsp;colors"</span>&nbsp;<span class="keyword">else</span>&nbsp;s&nbsp;<span class="string">"without&nbsp;colors"</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item&nbsp;<span class="string">"Get-key"</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="keyword">if</span>&nbsp;t.with_cbreak&nbsp;<span class="keyword">then</span>&nbsp;s&nbsp;<span class="string">"uses&nbsp;`cbreak`"</span>&nbsp;<span class="keyword">else</span>&nbsp;s&nbsp;<span class="string">"classic&nbsp;readline"</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item&nbsp;<span class="string">"Explorer"</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="keyword">let</span>&nbsp;{&nbsp;request_targets_ids;&nbsp;targets_per_page;&nbsp;targets_to_prefetch&nbsp;}&nbsp;=<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t.explorer&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sublist&nbsp;[<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item&nbsp;<span class="string">"Default&nbsp;request"</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="keyword">match</span>&nbsp;request_targets_ids&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">Younger_than</span>&nbsp;(<span class="keywordsign">`</span><span class="constructor">Days</span>&nbsp;days)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s&nbsp;<span class="string">"Targets&nbsp;younger&nbsp;than&nbsp;"</span>&nbsp;%&nbsp;f&nbsp;days&nbsp;%&nbsp;s&nbsp;<span class="string">"&nbsp;days"</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">All</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;s&nbsp;<span class="string">"All&nbsp;targets"</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item&nbsp;<span class="string">"Targets-per-page"</span>&nbsp;(i&nbsp;targets_per_page);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item&nbsp;<span class="string">"Targets-to-prefectch"</span>&nbsp;(i&nbsp;targets_to_prefetch);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]);<br>
&nbsp;&nbsp;&nbsp;&nbsp;]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;engine&nbsp;{&nbsp;database_parameters;&nbsp;turn_unix_ssh_failure_into_target_failure;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;host_timeout_upper_bound;&nbsp;maximum_successive_attempts&nbsp;}&nbsp;=<br>
&nbsp;&nbsp;&nbsp;&nbsp;sublist&nbsp;[<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item&nbsp;<span class="string">"Database"</span>&nbsp;(quote&nbsp;database_parameters);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item&nbsp;<span class="string">"Unix-failure"</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="keyword">if</span>&nbsp;turn_unix_ssh_failure_into_target_failure<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">then</span>&nbsp;s&nbsp;<span class="string">"turns"</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;s&nbsp;<span class="string">"does&nbsp;not&nbsp;turn"</span>)&nbsp;%&nbsp;s&nbsp;<span class="string">"&nbsp;into&nbsp;target&nbsp;failure"</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item&nbsp;<span class="string">"Host-timeout-upper-bound"</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(option&nbsp;f&nbsp;host_timeout_upper_bound);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item&nbsp;<span class="string">"Maximum-successive-attempts"</span>&nbsp;(i&nbsp;maximum_successive_attempts);<br>
&nbsp;&nbsp;&nbsp;&nbsp;]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;authorized_tokens&nbsp;=&nbsp;<span class="keyword">function</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">Path</span>&nbsp;path&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;s&nbsp;<span class="string">"Path:&nbsp;"</span>&nbsp;%&nbsp;quote&nbsp;path<br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">Inline</span>&nbsp;(name,&nbsp;value)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;s&nbsp;<span class="string">"Inline&nbsp;"</span>&nbsp;%&nbsp;parens&nbsp;(s&nbsp;<span class="string">"Name:&nbsp;"</span>&nbsp;%&nbsp;s&nbsp;name&nbsp;%&nbsp;s&nbsp;<span class="string">",&nbsp;Value:&nbsp;"</span>&nbsp;%&nbsp;quote&nbsp;value)<br>
&nbsp;&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;t.mode&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">Standalone</span>&nbsp;{standalone_engine;&nbsp;standalone_ui}&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;toplevel&nbsp;[<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item&nbsp;<span class="string">"Mode"</span>&nbsp;(s&nbsp;<span class="string">"Standalone"</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item&nbsp;<span class="string">"Engine"</span>&nbsp;(engine&nbsp;standalone_engine);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item&nbsp;<span class="string">"UI"</span>&nbsp;(ui&nbsp;standalone_ui);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item&nbsp;<span class="string">"Misc"</span>&nbsp;common;<br>
&nbsp;&nbsp;&nbsp;&nbsp;]<br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">Client</span>&nbsp;client&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;toplevel&nbsp;[<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item&nbsp;<span class="string">"Mode"</span>&nbsp;(s&nbsp;<span class="string">"Client"</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item&nbsp;<span class="string">"Connection"</span>&nbsp;(quote&nbsp;client.connection);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item&nbsp;<span class="string">"Auth-token"</span>&nbsp;(quote&nbsp;client.token);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item&nbsp;<span class="string">"UI"</span>&nbsp;(ui&nbsp;client.client_ui);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item&nbsp;<span class="string">"Misc"</span>&nbsp;common;<br>
&nbsp;&nbsp;&nbsp;&nbsp;]<br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">Server</span>&nbsp;srv&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;toplevel&nbsp;[<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item&nbsp;<span class="string">"Mode"</span>&nbsp;(s&nbsp;<span class="string">"Server"</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item&nbsp;<span class="string">"Engine"</span>&nbsp;(engine&nbsp;srv.server_engine);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item&nbsp;<span class="string">"UI"</span>&nbsp;(ui&nbsp;srv.server_ui);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item&nbsp;<span class="string">"HTTP-server"</span>&nbsp;(sublist&nbsp;[<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item&nbsp;<span class="string">"Authorized&nbsp;tokens"</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(sublist&nbsp;(<span class="constructor">List</span>.map&nbsp;~f:authorized_tokens&nbsp;srv.authorized_tokens));<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item&nbsp;<span class="string">"Daemonize"</span>&nbsp;(<span class="constructor">OCaml</span>.bool&nbsp;srv.daemon);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item&nbsp;<span class="string">"Command&nbsp;Pipe"</span>&nbsp;(<span class="constructor">OCaml</span>.option&nbsp;quote&nbsp;srv.command_pipe);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item&nbsp;<span class="string">"Log-path"</span>&nbsp;(<span class="constructor">OCaml</span>.option&nbsp;quote&nbsp;srv.log_path);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item&nbsp;<span class="string">"Return-error-messages"</span>&nbsp;(<span class="constructor">OCaml</span>.bool&nbsp;srv.return_error_messages);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item&nbsp;<span class="string">"Max-blocking-time"</span>&nbsp;(<span class="constructor">OCaml</span>.float&nbsp;srv.max_blocking_time);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item&nbsp;<span class="string">"Block-step-time"</span>&nbsp;(<span class="constructor">OCaml</span>.float&nbsp;srv.block_step_time);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item&nbsp;<span class="string">"Listen"</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="keyword">let</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">Tls</span>&nbsp;(cert,&nbsp;key,&nbsp;port)&nbsp;=&nbsp;srv.listen_to&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sublist&nbsp;[<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item&nbsp;<span class="string">"Port"</span>&nbsp;(i&nbsp;port);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item&nbsp;<span class="string">"Certificate"</span>&nbsp;(quote&nbsp;cert);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item&nbsp;<span class="string">"Key"</span>&nbsp;(quote&nbsp;key);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;])<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item&nbsp;<span class="string">"Misc"</span>&nbsp;common;<br>
&nbsp;&nbsp;&nbsp;&nbsp;]</code></body></html>