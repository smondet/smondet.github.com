 <!DOCTYPE html> <html> <head><link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootswatch/3.2.0/readable/bootstrap.min.css" type="text/css">
<link rel="stylesheet" href="https://cdn.rawgit.com/hammerlab/ketrew/2d1c430cca52caa71e363a765ff8775a6ae14ba9/src/doc/code_style.css" type="text/css"><meta charset="utf-8"><title>Docout: Home</title></head><body><div class="container"><h1>Docout: Home</h1><div class="row">
<div class="col-md-3">
<h2>Contents</h2><ul><li><a href='#Example'>Example</a>
</li><li><a href='#EDSLCombinators'>EDSL Combinators</a>
</li></ul><h2>Menu</h2><ul><li><a href='index.html'>Home</a></li><li><a href='docout.html'>Literate Implementation</a></li><li><a href='./api/index.html'>API Documentation</a></li><li>Repository <a href='https://bitbucket.org/smondet/docout'>at Bitbucket</a></li><li>Up: <a href='../index.html'>Software Projects</a></li></ul></div><div class="col-md-9"><h1 id="Docout">Docout</h1>

<p>This library is a functor which creates a <code>Logging</code> module, i.e. a <code>printf</code> replacement
based on the <a href='https://github.com/clarus/smart-print'><code>smart-print</code></a> library (its only
dependency).</p>
<p>The module <a href='api/Docout.Make_logger.html' title='Docout.Make_logger'><code>Docout.Make_logger</code></a> takes a <a href='api/Docout.LOGGER_CONFIGURATION.html' title='LOGGER_CONFIGURATION'><code>LOGGER_CONFIGURATION</code></a> and
produces a <a href='api/Docout.LOGGER.html' title='LOGGER'><code>LOGGER</code></a> (which includes the <code>SmartPrint</code> module as well).</p>
<h2 id="Example">Example</h2>

<p>Let&#39;s apply the functor to a basic, <code>stderr</code> output logger-configuration:</p>
<pre><span class="kw">let</span><span class="text"> </span><span class="id">global_debug_level</span><span class="text"> = </span><span class="kw1">ref</span><span class="text"> </span><span class="numeric">2</span><span class="text">
</span><span class="kw">let</span><span class="text"> </span><span class="id">global_with_color</span><span class="text"> = </span><span class="kw1">ref</span><span class="text"> </span><span class="constant">true</span><span class="text">
</span><span class="kw">module</span><span class="text"> </span><span class="kw2">Log</span><span class="text"> = 
  </span><span class="kw2">Docout</span><span class="text">.</span><span class="kw2">Make_logger</span><span class="text"> (</span><span class="kw1">struct</span><span class="text">
    </span><span class="kw">type</span><span class="text"> ('</span><span class="id">a</span><span class="text">, '</span><span class="id">b</span><span class="text">) </span><span class="id">result</span><span class="text"> = '</span><span class="id">a</span><span class="text">
    </span><span class="kw">let</span><span class="text"> </span><span class="id">debug_level</span><span class="text"> () = !</span><span class="id">global_debug_level</span><span class="text">
    </span><span class="kw">let</span><span class="text"> </span><span class="id">with_color</span><span class="text"> () = !</span><span class="id">global_with_color</span><span class="text">
    </span><span class="kw">let</span><span class="text"> </span><span class="id">line_width</span><span class="text"> = </span><span class="numeric">72</span><span class="text">
    </span><span class="kw">let</span><span class="text"> </span><span class="id">indent</span><span class="text"> = </span><span class="numeric">4</span><span class="text">
    </span><span class="kw">let</span><span class="text"> </span><span class="id">print_string</span><span class="text"> = </span><span class="kw2">Printf</span><span class="text">.</span><span class="id">eprintf</span><span class="text"> </span><span class="string">"%s%!"</span><span class="text">
    </span><span class="kw">let</span><span class="text"> </span><span class="id">do_nothing</span><span class="text"> () = ()
    </span><span class="kw">let</span><span class="text"> </span><span class="id">name</span><span class="text"> = </span><span class="string">"docout-test"</span><span class="text">
  </span><span class="kw1">end</span><span class="text">)</span></pre>

<p>Then, one can build documents and display them:</p>
<pre><span class="kw2">Log</span><span class="text">.(</span><span class="id">s</span><span class="text"> </span><span class="string">"Some string "</span><span class="text"> % </span><span class="id">i</span><span class="text"> </span><span class="numeric">42</span><span class="text"> % </span><span class="id">sf</span><span class="text"> </span><span class="string">", %S"</span><span class="text"> </span><span class="string">"quoted"</span><span class="text">
     % </span><span class="id">sp</span><span class="text"> % </span><span class="id">brakets</span><span class="text"> (</span><span class="kw2">OCaml</span><span class="text">.</span><span class="kw3">list</span><span class="text"> </span><span class="id">f</span><span class="text"> [</span><span class="numeric">3.14</span><span class="text">; </span><span class="numeric">4.2</span><span class="text">])
     @ </span><span class="id">very_verbose</span><span class="text">);</span></pre>

<h2 id="EDSLCombinators">EDSL Combinators</h2>

<p>On top of all of <a href='https://github.com/clarus/smart-print'><code>SmartPrint</code></a> values;
<a href='api/Docout.LOGGER.html' title='LOGGER'><code>LOGGER</code></a> offers:</p>
<ul><li><code>%</code>: pure concatenation,</li><li><code>s</code>: wrapped string (i.e. Natural language text); the leading and closing
 spaces are preserved,</li><li><code>sp</code>: a breakable space,</li><li><code>sf</code>: like <code>s</code> for formats (equivalent to <code>(s (sprintf &quot;…&quot;))</code>,</li><li><code>i</code>, <code>f</code>: ints; floats,</li><li><code>n</code>: forced new line,</li><li><code>verbatim</code>: non-reformatted strings,</li><li><code>exn</code>: OCaml exceptions,</li><li><code>option</code>: OCaml option combinator,</li><li><code>escape</code>: escape a string (for OCaml lexical conventions),</li><li>ANSI colors: <code>color</code>, <code>bold_red</code>, <code>bold_yellow</code>, <code>bold_green</code>, and <code>greyish</code>.</li></ul>

<p>The documents created with the EDSL are conditionally passed to
<code>LOGGER_CONFIGURATION.print_string</code> with the <code>@</code> operator and a <em>“level”</em>:
<code>normal</code>, <code>error</code>, <code>warning</code>, <code>verbose</code>, or <code>very_verbose</code>.</p>
<p>We also provide some <em>nicer</em> conversion functions for <code>SmartPrint.t</code>:</p>
<pre><span class="text">  </span><span class="kw">val</span><span class="text"> </span><span class="id">to_string</span><span class="text"> : </span><span class="id">line_width</span><span class="text">:</span><span class="kw3">int</span><span class="text"> -&gt; </span><span class="id">indent</span><span class="text">:</span><span class="kw3">int</span><span class="text"> -&gt; </span><span class="kw2">SmartPrint</span><span class="text">.</span><span class="id">t</span><span class="text"> -&gt; </span><span class="kw3">string</span><span class="text">
  </span><span class="kw">val</span><span class="text"> </span><span class="id">to_list</span><span class="text"> :
    </span><span class="id">line_width</span><span class="text">:</span><span class="kw3">int</span><span class="text"> -&gt;
    </span><span class="id">indent</span><span class="text">:</span><span class="kw3">int</span><span class="text"> -&gt;
    </span><span class="kw2">SmartPrint</span><span class="text">.</span><span class="id">t</span><span class="text"> -&gt;
    [&gt; `</span><span class="kw2">Char</span><span class="text"> </span><span class="kw">of</span><span class="text"> </span><span class="kw3">char</span><span class="text">
    | `</span><span class="kw2">String</span><span class="text"> </span><span class="kw">of</span><span class="text"> </span><span class="kw3">string</span><span class="text">
    | `</span><span class="kw2">Sub_string</span><span class="text"> </span><span class="kw">of</span><span class="text"> </span><span class="kw3">string</span><span class="text"> * </span><span class="kw3">int</span><span class="text"> * </span><span class="kw3">int</span><span class="text"> ] </span><span class="kw3">list</span></pre></div></div></div></body><html>