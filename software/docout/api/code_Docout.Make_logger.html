<html><head>
<link rel="stylesheet" href="style.css" type="text/css">
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<link rel="Start" href="index.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="Index of module types" rel=Appendix href="index_module_types.html">
<link title="Docout" rel="Chapter" href="Docout.html"><title>Docout.Make_logger</title>
</head>
<body>
<code class="code">(<span class="constructor">P</span>&nbsp;:&nbsp;<span class="constructor">LOGGER_CONFIGURATION</span>)&nbsp;:&nbsp;<br>
&nbsp;&nbsp;<span class="constructor">LOGGER</span>&nbsp;<span class="keyword">with</span>&nbsp;<span class="keyword">type</span>&nbsp;(<span class="keywordsign">'</span>a,&nbsp;<span class="keywordsign">'</span>b)&nbsp;result&nbsp;=&nbsp;(<span class="keywordsign">'</span>a,&nbsp;<span class="keywordsign">'</span>b)&nbsp;<span class="constructor">P</span>.result&nbsp;=&nbsp;<span class="keyword">struct</span><br>
<br>
&nbsp;&nbsp;<span class="keyword">include</span>&nbsp;<span class="constructor">Metadoc</span><br>
&nbsp;&nbsp;<span class="keyword">type</span>&nbsp;(<span class="keywordsign">'</span>a,&nbsp;<span class="keywordsign">'</span>b)&nbsp;result&nbsp;=&nbsp;(<span class="keywordsign">'</span>a,&nbsp;<span class="keywordsign">'</span>b)&nbsp;<span class="constructor">P</span>.result<br>
&nbsp;&nbsp;<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;print&nbsp;log_kind&nbsp;t&nbsp;=<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;convert_to_string&nbsp;formatted&nbsp;=<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">SmartPrint</span>.to_string&nbsp;<span class="constructor">P</span>.line_width&nbsp;<span class="constructor">P</span>.indent&nbsp;formatted&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;display&nbsp;formatted&nbsp;=&nbsp;convert_to_string&nbsp;formatted&nbsp;|&gt;&nbsp;<span class="constructor">P</span>.print_string&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;using_colors&nbsp;=&nbsp;<span class="constructor">P</span>.with_color&nbsp;()&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;no_color&nbsp;t&nbsp;=&nbsp;t&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;normal_color&nbsp;=&nbsp;<span class="keyword">if</span>&nbsp;using_colors&nbsp;<span class="keyword">then</span>&nbsp;bold_green&nbsp;<span class="keyword">else</span>&nbsp;no_color&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;error_color&nbsp;=&nbsp;<span class="keyword">if</span>&nbsp;using_colors&nbsp;<span class="keyword">then</span>&nbsp;bold_red&nbsp;<span class="keyword">else</span>&nbsp;no_color&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;warning_color&nbsp;=&nbsp;<span class="keyword">if</span>&nbsp;using_colors&nbsp;<span class="keyword">then</span>&nbsp;bold_yellow&nbsp;<span class="keyword">else</span>&nbsp;no_color&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;debug_color&nbsp;=&nbsp;<span class="keyword">if</span>&nbsp;using_colors&nbsp;<span class="keyword">then</span>&nbsp;greyish&nbsp;<span class="keyword">else</span>&nbsp;no_color&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;format_log&nbsp;?(color_h=no_color)&nbsp;?(color_t=no_color)&nbsp;head&nbsp;t&nbsp;=<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;colorless&nbsp;=&nbsp;head&nbsp;%&nbsp;t&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;has_newline&nbsp;=<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">String</span>.find_index&nbsp;(convert_to_string&nbsp;colorless)&nbsp;~char:<span class="string">'\n'</span>&nbsp;&lt;&gt;&nbsp;<span class="constructor">None</span>&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;display&nbsp;(<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color_h&nbsp;(brakets&nbsp;head)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%&nbsp;string&nbsp;<span class="string">"&nbsp;"</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%&nbsp;(<span class="keyword">if</span>&nbsp;has_newline<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">then</span>&nbsp;color_t&nbsp;(n&nbsp;%&nbsp;indent&nbsp;t)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;color_t&nbsp;t)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%&nbsp;newline<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;log_kind&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">Normal</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;format_log&nbsp;~color_h:normal_color&nbsp;(string&nbsp;<span class="constructor">P</span>.name)&nbsp;t<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">Error</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;format_log&nbsp;~color_h:error_color&nbsp;(s&nbsp;<span class="constructor">P</span>.name&nbsp;%&nbsp;s&nbsp;<span class="string">":&nbsp;ERROR"</span>)&nbsp;t<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">Warning</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;format_log&nbsp;~color_h:warning_color&nbsp;(s&nbsp;<span class="constructor">P</span>.name&nbsp;%&nbsp;s&nbsp;<span class="string">":&nbsp;Warning"</span>)&nbsp;t<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">Debug</span>&nbsp;level&nbsp;<span class="keyword">when</span>&nbsp;<span class="constructor">P</span>.debug_level&nbsp;()&nbsp;&gt;=&nbsp;level&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;format_log&nbsp;&nbsp;~color_h:debug_color&nbsp;(s&nbsp;<span class="constructor">P</span>.name&nbsp;%s&nbsp;&nbsp;<span class="string">":&nbsp;debug"</span>)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~color_t:debug_color&nbsp;t<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">Debug</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">P</span>.do_nothing&nbsp;()<br>
<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;(@)&nbsp;t&nbsp;kind&nbsp;=&nbsp;print&nbsp;kind&nbsp;t<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;normal&nbsp;=&nbsp;<span class="keywordsign">`</span><span class="constructor">Normal</span>&nbsp;<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;error&nbsp;=&nbsp;<span class="keywordsign">`</span><span class="constructor">Error</span>&nbsp;<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;warning&nbsp;=&nbsp;<span class="keywordsign">`</span><span class="constructor">Warning</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;verbose&nbsp;=&nbsp;<span class="keywordsign">`</span><span class="constructor">Debug</span>&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;very_verbose&nbsp;=&nbsp;<span class="keywordsign">`</span><span class="constructor">Debug</span>&nbsp;2<br>
<span class="keyword">end</span></code></body></html>