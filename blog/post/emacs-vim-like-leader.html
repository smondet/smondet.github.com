<!DOCTYPE html
PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<!-- Generated with Dibrawi, BraceTax, Sebib, and some more hacks -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<style type="text/css">
body {
   color: #020202;
   background-color: #fff;
}
div.content {
   color: #020202;
   background-color: #fff;
}
div.sidepane {
   color: #020202;
   background-color: #fff;
}
 {
   color: #020202;
   background-color: #fff;
}
a:link {
   color: #B41D1D;
}
a:visited {
   color: #671010;
}
a:hover {
   background-color: #BFFCD1;
}
tt {
   color: #1B3A23;
}pre {
   color: #1B3A23;
}code {
   color: #1B3A23;
}
.dbwmixcode {
   background-color: #BFFCD1;
}
div.figure:after {
   color: #B41D1D;
}caption.tablefigure:after {
   color: #B41D1D;
}
body {
   font-family: serif;
   text-align: left;
   font-size: 90%;

}
 {
   font-family: serif;
   text-align: left;
   font-size: 90%;

}
div.header {
   text-align: center;

}
h1 {
   font-size: 200%;
   font-variant: small-caps;

}
div.authors {
   font-size: 110%;

}
div.subtitle {
   font-size: 110%;
   font-style: italic;
}
h2 {
   font-size: 180%;

}
h3 {
   font-size: 150%;

}
h4 {
   font-size: 130%;

}
h5 {
   font-size: 108%;

}
a {
   text-decoration: underline thin;
}
tt,code,pre {
   font-family: monospace;

}
div.figure,div.tablefigure {
   font-size: 90%;

}
.content body {
   font-family: serif;
   text-align: justify;
   font-size: 100%;

}
.content  {
   font-family: serif;
   text-align: justify;
   font-size: 100%;

}
.content div.header {
   text-align: center;

}
.content h1 {
   font-size: 200%;
   font-variant: small-caps;

}
.content div.authors {
   font-size: 110%;

}
.content div.subtitle {
   font-size: 110%;
   font-style: italic;
}
.content h2 {
   font-size: 180%;

}
.content h3 {
   font-size: 150%;

}
.content h4 {
   font-size: 130%;

}
.content h5 {
   font-size: 108%;

}
.content a {
   text-decoration: underline thin;
}
.content tt,code,pre {
   font-family: monospace;

}
.content div.figure,div.tablefigure {
   font-size: 90%;

}
div.header {
    text-align: center;
    border:  #B41D1D solid 5px;
    padding-top:    2.1em;
    padding-bottom: 2.05em;
    margin-bottom: 3em;
}
div.p {
    padding-bottom: 0em;
}
div.p + div.p { padding-top: 0.5em; }
body {overflow: auto;}
code,pre {overflow: auto}
blockquote {
    border-left: 2px solid #020202;
    padding-left: 1em;
}
ul, ol {
    padding-top: 0em;
    padding-bottom: 0em;
    padding-left:  1.8em;
    margin-top: 0em;
    margin-bottom: 0em;
}
.dibrawicomment:before { content:  "["; }
.dibrawicomment:after { content: "]"; }
.dibrawicomment {
    background-color: yellow;
    color: red;
}
.dibrawimenudir { display: block; }
         ul  li.dibrawi_menuli {
           display: inline;
         } 
         ul.dibrawi_menuul {
           padding: 0em;
           margin: 0em;
           margin-left: 1em;
         }
table.tablefigure {
    margin-right:auto;
    margin-left: auto;
    border-collapse: collapse;
    min-width: 80%;
    margin-bottom: 1em;
}
caption.tablefigure {
    caption-side:bottom;
}
div.figure:after, caption.tablefigure:after { content: " [" attr(id) "]"; }
td, th {
    padding: 0.4em;
}
img {
    border: none;
    padding-bottom: 0.5em;
}div.figure, div.tablefigure {
    text-align: center;
    font-size:90%;
    border: thin #959595 solid;
    padding: 1ex;
    margin: 1em;
    width: 90%;
    margin-left: 5%;
    margin-right: 0em;
    clear: both;

}
small.notebegin { font-size: 70%; vertical-align: super; counter-increment: footnote; }
small.noteend { font-size: 70%; vertical-align: super; }
small.noteend:before {  content: counter(footnote) }
small.note:before { content: counter(footnote) ": " }
body { counter-reset: section subsection subsubsection footnote; }

small.note {
    font-size: 76%;
    clear: right;
    width: 32%;
    border: thin #959595 solid;
    float: right;
    margin: 0.5em;
    margin-right: 0em;
    padding: 0.5em;
}
h2 { border: #B41D1D solid 2px; padding: 0.2em; }
h3 { text-decoration: underline;}
pre {
    position: relative; left: 5%; max-width: 90%; clear: left;
}
div.sidepane {
  left: 0.5%; width: 19.000000%; padding: 0.5%;
  border-right: #B41D1D ridge 1px;
    top: 2px;
    position:fixed;
    overflow: auto;
    bottom: 2px;
}
div.content {
max-width : 45em; left: 21.000000%; right: 0.5%; padding: 0.2em;
    top: 2px;
    position: absolute;
}
</style>
<link rel="shortcut icon" href="http://seb.mondet.org/images/sm.ico">
<link rel="alternate" type="application/rss+xml" title="RSS" href="http://seb.mondet.org/blog/feed/all_posts.rss">
<title>Seb's Blog: Vim-like Leader Keys In Emacs</title>
</head>
<body>
<div class="content">
<div class="p"></div>
<h2 id="Vim_like_Leader_Keys_In_Emacs">Vim-like Leader Keys In Emacs</h2>
<div class="p"> <small> âž²&nbsp;&nbsp;<b>Date:</b> <i>Wed, 04 May 2011 13:18:02 +0200</i>; <b>Tags:</b> <tt>[<a href="../feed/hack_of_the_day.rss"><tt>hack_of_the_day</tt></a>; <a href="../feed/emacs.rss"><tt>emacs</tt></a>]</tt>. </small><br/>
<br/>
             </div>
<div class="p">  </div>
<h4 id="The_Problem">The Problem</h4>
<div class="p">  We want an equivalent of Vim's <tt>Leader</tt> keys  (c.f. <a href="http://stackoverflow.com/questions/1764263/what-is-the-leader-in-a-vimrc-file">this stackoverflow question</a>) for our own key-bindings. In other words, we want to prefix all the defined shortcuts with a given key-binding in order not to mess too much with Emacs or with modes implemented by other people. We also want to make it easy to define new keys, for functions or for any piece of code, and we want to be able to easily change the <tt>Leader</tt> key.  </div>
<h4 id="The_Current_Solution">The Current Solution</h4>
<div class="p">  In your <tt>.emacs</tt> file, before all the nasty hacks that you want to prefix, the idea is first to define a new &ldquo;keymap&rdquo; for your bindings. It is called <tt>dkeys</tt> for no particular reason here: <pre>
(setq dkeys-map (make-sparse-keymap))
</pre> Then we choose one arbitrary leading key, here <tt>Ctrl-D</tt><small class="notebegin">(</small><small class="note">I use the <a href="http://ergoemacs.org/">ErgoEmacs</a>' and <a href="http://www.emacswiki.org/CuaMode">CUA</a> modes, so <tt>Ctrl-D</tt> is unused in my setup.</small><small class="noteend">)</small>, but any combination of keystrokes may be used. The <tt>global-unset-key</tt> should be applied only to the first of the string: <pre>
(setq dkeys-leading-key "\C-d")
(global-unset-key "\C-d")
</pre> </div>
<div class="p">  To be &ldquo;clean&rdquo;, we define a minor mode, and activate it<small class="notebegin">(</small><small class="note">the minor mode is actually not mandatory but this way you can define many different ones, and activate them on-demand.</small><small class="noteend">)</small>: <pre>
(define-minor-mode dkeys-mode
  "C-d-Keys mode"
  :lighter " Dkey"
  :global t
  :keymap dkeys-map)
(dkeys-mode 1)
</pre> </div>
<div class="p">  To simplify key-bindings we create a function to bind a key-sequence to a function: <pre>
(defun set-dkey(key function)
  (define-key dkeys-map 
              (concat dkeys-leading-key key)
              function))
</pre> The function just adds the <tt>Leader</tt>, and defines the key-binding in the minor mode. </div>
<div class="p">  As we are lazy, we define a macro<small class="notebegin">(</small><small class="note">When hacking macros you might want to use the <tt>macroexpand</tt> function <a href="http://www.gnu.org/software/emacs/elisp/html_node/Expansion.html">to solve some headaches</a>.</small><small class="noteend">)</small> which defines <i>interactive</i> functions, and binds them to the keys at once: <pre>
(defmacro dkeys-funkey (key name function)
  (list
   'progn
   (list 'defun name '()
     '(interactive) function)
   (list 'define-key 'dkeys-map 
     (list 'concat 'dkeys-leading-key key) 
     (list 'quote name))))
</pre> </div>
<div class="p">  Finally, each definition can be simply added to that minor mode. For example, this <i>key-bound-function</i>, inserts some text when <tt>"C-d o o"</tt> is typed: <pre>
(dkeys-funkey "oo" express-astonishment
            (progn
              (insert "oooooohhhh!!!")))
</pre> </div>
<div class="p">  That's it. Happy Emacs Hacking!  </div>
<div class="p"><hr/><div id="disqus_thread"></div>
  <script type="text/javascript">
      var disqus_shortname = 'sebmondetblog'; 
      // required: replace example with your forum shortname
  
      // The following are highly recommended additional
      // parameters. Remove the slashes in front to use.
      var disqus_identifier = 'emacs-vim-like-leader';
      var disqus_url = 'http://seb.mondet.org/./blog/post/emacs-vim-like-leader.html';
  
      /* * * DON'T EDIT BELOW THIS LINE * * */
      (function() {
          var dsq = document.createElement('script');
          dsq.type = 'text/javascript'; dsq.async = true;
          dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] ||
             document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
  </script>
  <noscript>Please enable JavaScript to view the
  <a href="http://disqus.com/?ref_noscript">comments powered
  by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">blog
  comments powered by <span class="logo-disqus">Disqus</span></a></div>

<div id="pagefoot" />
</div>
<div class="sidepane">
<h1>Sebastien Mondet</h1><br/>
<b>Menu: </b><div class="p">
<ul>
  <li> <a href="../../index.html">Home</a>  </li>
<li> <a href="../../publications.html">Publications</a>  </li>
<li> <a href="../../software.html">Software</a>  </li>
<li> <a href="../../blog/index.html">Blog</a> </li>
</ul>
 </div>
<br/>
<br/>
<br/>
<br/>
<br/>
<small><div class="p"> Site generated thanks to  <a href="http://bracetax.berlios.de/">bracetax</a>, <a href="http://martin.jambon.free.fr/camlmix/">camlmix</a>, <a href="http://sebib.forge.ocamlcore.org/">sebib</a>, and <a href="https://github.com/smondet/dibrawi">more&nbsp;&hellip;</a> <br/>
 Updated on Wed, 17 Aug 2011 21:13:07 +0200. <br/>
 <a href="http://seb.mondet.org">Sebastien Mondet</a><br/>
<br/>
 </small>
<a href="http://caml.inria.fr/">
  <img src="http://caml.inria.fr//pub/logos/caml-powered.80x30.png"
       alt="Powered by Caml"
       style="border: none;" />
</a> </div>
<br/>
</div>
</body></html>
