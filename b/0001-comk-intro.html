<html>
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>
    </style>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/openpgp/4.0.0/openpgp.min.js"
    ></script>
</head>
<body>
<h2>PGP-Encrypted Page, please provide a passphrase.</h2>
<form id="staticrypt-form" action="#" method="post">
   <input id="staticrypt-password"
          type="password"
          name="password"
          placeholder="passphrase"
          autofocus/>
   <input id="staticrypt-form-submit"
          type="submit"
          value="DECRYPT"/>
</form>
<div id="errors"></div>
<code><pre id="armored-content">
-----BEGIN PGP MESSAGE-----

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
fWZo3PtpBGEBUJ32gyss16U=
=7BQQ
-----END PGP MESSAGE-----
</pre></code>
<script>

function tryPassphrase(passphrase,silent) {
    console.log("tryPassphrase " + passphrase);
    var openpgp = window.openpgp;
    var options, encrypted;
    var encryptedMsg = document.getElementById('armored-content').innerHTML ;
    
    var armoredmsg = encryptedMsg.replace(/@/g, "\n");
    console.log("armoredmsg:\n" + armoredmsg);
    return openpgp.message.readArmored(armoredmsg).then(function (msg) {
        // console.log("msg " + JSON.stringify(msg));
        console.log("passphrase " + JSON.stringify(passphrase));
        options = {
            message: msg,
            passwords: [passphrase], // decrypt with password
            armor: true,
            format: 'utf8'
        };
        openpgp.decrypt(options).then(function(plaintext) {
            console.log("plaintext of msg " + JSON.stringify(plaintext));
            document.open("text/html", "replace");
            document.write(plaintext.data);
            document.close();
            return true;
        }).catch(function (error) {
            if (silent) {
                console.log("error: " + error);
            } else {
                var errors = document.getElementById('errors');
                errors.innerHTML = '<b>ERROR: decryption failed: </b><code>'
                    + error
                    + '</code> <i>(usually means wrong password …)</i>';
            };
        });
    });
};
console.log("Setting on submit");
document.getElementById('staticrypt-form').addEventListener('submit', function(e) {
    e.preventDefault();
    console.log("on the submit");
    var passphrase = document.getElementById('staticrypt-password').value;
    console.log("on the submit passph: " + passphrase);
    tryPassphrase(passphrase, false);
});
window.onload = function() { 
    var firstAttempt = "";
    if (window.location.hash.charAt(0) == '#') {
        firstAttempt = window.location.hash.substring(1);
    } else {
        firstAttempt = window.location.hash
    };
    tryPassphrase(firstAttempt, true).then(function(ret) {
        if (ret) {
            console.log("on the else of firstAttempt");
        } else {
            console.log("Nope from the hash: " + firstAttempt);
        };
    }, function(error) {
        console.log("Error from tryPassphrase: " + error);
    });
};
</script>
</body>
</html>
