<html>
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>
    </style>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/openpgp/4.0.0/openpgp.min.js"
    ></script>
</head>
<body>
<h2>PGP-Encrypted Page, please provide a passphrase.</h2>
<form id="staticrypt-form" action="#" method="post">
   <input id="staticrypt-password"
          type="password"
          name="password"
          placeholder="passphrase"
          autofocus/>
   <input id="staticrypt-form-submit"
          type="submit"
          value="DECRYPT"/>
</form>
<div id="errors"></div>
<code><pre id="armored-content">
-----BEGIN PGP MESSAGE-----

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
=KRku
-----END PGP MESSAGE-----
</pre></code>
<script>

function tryPassphrase(passphrase,silent) {
    console.log("tryPassphrase " + passphrase);
    var openpgp = window.openpgp;
    var options, encrypted;
    var encryptedMsg = document.getElementById('armored-content').innerHTML ;
    
    var armoredmsg = encryptedMsg.replace(/@/g, "\n");
    console.log("armoredmsg:\n" + armoredmsg);
    return openpgp.message.readArmored(armoredmsg).then(function (msg) {
        // console.log("msg " + JSON.stringify(msg));
        console.log("passphrase " + JSON.stringify(passphrase));
        options = {
            message: msg,
            passwords: [passphrase], // decrypt with password
            armor: true,
            format: 'utf8'
        };
        openpgp.decrypt(options).then(function(plaintext) {
            console.log("plaintext of msg " + JSON.stringify(plaintext));
            document.open("text/html", "replace");
            document.write(plaintext.data);
            document.close();
            return true;
        }).catch(function (error) {
            if (silent) {
                console.log("error: " + error);
            } else {
                var errors = document.getElementById('errors');
                errors.innerHTML = '<b>ERROR: decryption failed: </b><code>'
                    + error
                    + '</code> <i>(usually means wrong password …)</i>';
            };
        });
    });
};
console.log("Setting on submit");
document.getElementById('staticrypt-form').addEventListener('submit', function(e) {
    e.preventDefault();
    console.log("on the submit");
    var passphrase = document.getElementById('staticrypt-password').value;
    console.log("on the submit passph: " + passphrase);
    tryPassphrase(passphrase, false);
});
window.onload = function() { 
    var firstAttempt = "";
    if (window.location.hash.charAt(0) == '#') {
        firstAttempt = window.location.hash.substring(1);
    } else {
        firstAttempt = window.location.hash
    };
    tryPassphrase(firstAttempt, true).then(function(ret) {
        if (ret) {
            console.log("on the else of firstAttempt");
        } else {
            console.log("Nope from the hash: " + firstAttempt);
        };
    }, function(error) {
        console.log("Error from tryPassphrase: " + error);
    });
};
</script>
</body>
</html>
