<html>
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>
    </style>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/openpgp/4.0.0/openpgp.min.js"
    ></script>
</head>
<body>
<h2>PGP-Encrypted Page, please provide a passphrase.</h2>
<form id="staticrypt-form" action="#" method="post">
   <input id="staticrypt-password"
          type="password"
          name="password"
          placeholder="passphrase"
          autofocus/>
   <input id="staticrypt-form-submit"
          type="submit"
          value="DECRYPT"/>
</form>
<div id="errors"></div>
<code><pre id="armored-content">
-----BEGIN PGP MESSAGE-----

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
=fs36
-----END PGP MESSAGE-----
</pre></code>
<script>

function tryPassphrase(passphrase,silent) {
    console.log("tryPassphrase " + passphrase);
    var openpgp = window.openpgp;
    var options, encrypted;
    var encryptedMsg = document.getElementById('armored-content').innerHTML ;
    
    var armoredmsg = encryptedMsg.replace(/@/g, "\n");
    console.log("armoredmsg:\n" + armoredmsg);
    return openpgp.message.readArmored(armoredmsg).then(function (msg) {
        // console.log("msg " + JSON.stringify(msg));
        console.log("passphrase " + JSON.stringify(passphrase));
        options = {
            message: msg,
            passwords: [passphrase], // decrypt with password
            armor: true,
            format: 'utf8'
        };
        openpgp.decrypt(options).then(function(plaintext) {
            console.log("plaintext of msg " + JSON.stringify(plaintext));
            document.open("text/html", "replace");
            document.write(plaintext.data);
            document.close();
            return true;
        }).catch(function (error) {
            if (silent) {
                console.log("error: " + error);
            } else {
                var errors = document.getElementById('errors');
                errors.innerHTML = '<b>ERROR: decryption failed: </b><code>'
                    + error
                    + '</code> <i>(usually means wrong password …)</i>';
            };
        });
    });
};
console.log("Setting on submit");
document.getElementById('staticrypt-form').addEventListener('submit', function(e) {
    e.preventDefault();
    console.log("on the submit");
    var passphrase = document.getElementById('staticrypt-password').value;
    console.log("on the submit passph: " + passphrase);
    tryPassphrase(passphrase, false);
});
window.onload = function() { 
    var firstAttempt = "";
    if (window.location.hash.charAt(0) == '#') {
        firstAttempt = window.location.hash.substring(1);
    } else {
        firstAttempt = window.location.hash
    };
    tryPassphrase(firstAttempt, true).then(function(ret) {
        if (ret) {
            console.log("on the else of firstAttempt");
        } else {
            console.log("Nope from the hash: " + firstAttempt);
        };
    }, function(error) {
        console.log("Error from tryPassphrase: " + error);
    });
};
</script>
</body>
</html>
