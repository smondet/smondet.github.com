<html>
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>
    </style>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/openpgp/4.0.0/openpgp.min.js"
      integrity="sha512-LsI4YA/OY2EMDyHS4lWWUweqqcQXRi5RACGFsemrbqQAguNpNNhjRaJcua7Pvu+SZxGR1vbINmbRM1StWO9Z/Q=="
      crossorigin="anonymous"
    ></script>
</head>
<body>
<h2>PGP-Encrypted Page, please provide a passphrase.</h2>
<form id="staticrypt-form" action="#" method="post">
   <input id="staticrypt-password"
          type="password"
          name="password"
          placeholder="passphrase"
          autofocus/>
   <input id="staticrypt-form-submit"
          type="submit"
          value="DECRYPT"/>
</form>
<div id="errors"></div>
<code><pre id="armored-content">
-----BEGIN PGP MESSAGE-----

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
=e8qh
-----END PGP MESSAGE-----
</pre></code>
<script>

function tryPassphrase(passphrase,silent) {
    console.log("tryPassphrase " + passphrase);
    var openpgp = window.openpgp;
    var options, encrypted;
    var encryptedMsg = document.getElementById('armored-content').innerHTML ;
    
    var armoredmsg = encryptedMsg.replace(/@/g, "\n");
    console.log("armoredmsg:\n" + armoredmsg);
    return openpgp.message.readArmored(armoredmsg).then(function (msg) {
        // console.log("msg " + JSON.stringify(msg));
        console.log("passphrase " + JSON.stringify(passphrase));
        options = {
            message: msg,
            passwords: [passphrase], // decrypt with password
            armor: true,
            format: 'utf8'
        };
        openpgp.decrypt(options).then(function(plaintext) {
            console.log("plaintext of msg " + JSON.stringify(plaintext));
            document.open("text/html", "replace");
            document.write(plaintext.data);
            var meta = document.createElement('meta');
            meta.name = "referrer";
            meta.content = "no-referrer";
            document.getElementsByTagName('head')[0].appendChild(meta);
            document.close();
            return true;
        }).catch(function (error) {
            if (silent) {
                console.log("error: " + error);
            } else {
                var errors = document.getElementById('errors');
                errors.innerHTML = '<b>ERROR: decryption failed: </b><code>'
                    + error
                    + '</code> <i>(usually means wrong password …)</i>';
            };
        });
    });
};
console.log("Setting on submit");
document.getElementById('staticrypt-form').addEventListener('submit', function(e) {
    e.preventDefault();
    console.log("on the submit");
    var passphrase = document.getElementById('staticrypt-password').value;
    console.log("on the submit passph: " + passphrase);
    tryPassphrase(passphrase, false);
});
window.onload = function() { 
    var firstAttempt = "";
    if (window.location.hash.charAt(0) == '#') {
        firstAttempt = window.location.hash.substring(1);
    } else {
        firstAttempt = window.location.hash
    };
    tryPassphrase(firstAttempt, true).then(function(ret) {
        if (ret) {
            console.log("on the else of firstAttempt");
        } else {
            console.log("Nope from the hash: " + firstAttempt);
        };
    }, function(error) {
        console.log("Error from tryPassphrase: " + error);
    });
};
</script>
</body>
</html>
