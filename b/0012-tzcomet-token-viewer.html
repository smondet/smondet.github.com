<html>
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>
    </style>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/openpgp/4.0.0/openpgp.min.js"
      integrity="sha512-LsI4YA/OY2EMDyHS4lWWUweqqcQXRi5RACGFsemrbqQAguNpNNhjRaJcua7Pvu+SZxGR1vbINmbRM1StWO9Z/Q=="
      crossorigin="anonymous"
    ></script>
</head>
<body>
<h2>PGP-Encrypted Page, please provide a passphrase.</h2>
<form id="staticrypt-form" action="#" method="post">
   <input id="staticrypt-password"
          type="password"
          name="password"
          placeholder="passphrase"
          autofocus/>
   <input id="staticrypt-form-submit"
          type="submit"
          value="DECRYPT"/>
</form>
<div id="errors"></div>
<code><pre id="armored-content">
-----BEGIN PGP MESSAGE-----

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
6qFSY6D12Qe1jVa5uzfiPTMyipOjHEmJSJ6rRA==
=mYcQ
-----END PGP MESSAGE-----
</pre></code>
<script>

function tryPassphrase(passphrase,silent) {
    console.log("tryPassphrase " + passphrase);
    var openpgp = window.openpgp;
    var options, encrypted;
    var encryptedMsg = document.getElementById('armored-content').innerHTML ;
    
    var armoredmsg = encryptedMsg.replace(/@/g, "\n");
    console.log("armoredmsg:\n" + armoredmsg);
    return openpgp.message.readArmored(armoredmsg).then(function (msg) {
        // console.log("msg " + JSON.stringify(msg));
        console.log("passphrase " + JSON.stringify(passphrase));
        options = {
            message: msg,
            passwords: [passphrase], // decrypt with password
            armor: true,
            format: 'utf8'
        };
        openpgp.decrypt(options).then(function(plaintext) {
            console.log("plaintext of msg " + JSON.stringify(plaintext));
            document.open("text/html", "replace");
            document.write(plaintext.data);
            var meta = document.createElement('meta');
            meta.name = "referrer";
            meta.content = "no-referrer";
            document.getElementsByTagName('head')[0].appendChild(meta);
            document.close();
            return true;
        }).catch(function (error) {
            if (silent) {
                console.log("error: " + error);
            } else {
                var errors = document.getElementById('errors');
                errors.innerHTML = '<b>ERROR: decryption failed: </b><code>'
                    + error
                    + '</code> <i>(usually means wrong password …)</i>';
            };
        });
    });
};
console.log("Setting on submit");
document.getElementById('staticrypt-form').addEventListener('submit', function(e) {
    e.preventDefault();
    console.log("on the submit");
    var passphrase = document.getElementById('staticrypt-password').value;
    console.log("on the submit passph: " + passphrase);
    tryPassphrase(passphrase, false);
});
window.onload = function() { 
    var firstAttempt = "";
    if (window.location.hash.charAt(0) == '#') {
        firstAttempt = window.location.hash.substring(1);
    } else {
        firstAttempt = window.location.hash
    };
    tryPassphrase(firstAttempt, true).then(function(ret) {
        if (ret) {
            console.log("on the else of firstAttempt");
        } else {
            console.log("Nope from the hash: " + firstAttempt);
        };
    }, function(error) {
        console.log("Error from tryPassphrase: " + error);
    });
};
</script>
</body>
</html>
