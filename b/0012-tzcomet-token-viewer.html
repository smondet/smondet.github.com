<html>
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>
    </style>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/openpgp/4.0.0/openpgp.min.js"
      integrity="sha512-LsI4YA/OY2EMDyHS4lWWUweqqcQXRi5RACGFsemrbqQAguNpNNhjRaJcua7Pvu+SZxGR1vbINmbRM1StWO9Z/Q=="
      crossorigin="anonymous"
    ></script>
</head>
<body>
<h2>PGP-Encrypted Page, please provide a passphrase.</h2>
<form id="staticrypt-form" action="#" method="post">
   <input id="staticrypt-password"
          type="password"
          name="password"
          placeholder="passphrase"
          autofocus/>
   <input id="staticrypt-form-submit"
          type="submit"
          value="DECRYPT"/>
</form>
<div id="errors"></div>
<code><pre id="armored-content">
-----BEGIN PGP MESSAGE-----

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
V0cLRVW2YvhQFkq5kagYpxphGo0=
=+v7v
-----END PGP MESSAGE-----
</pre></code>
<script>

function tryPassphrase(passphrase,silent) {
    console.log("tryPassphrase " + passphrase);
    var openpgp = window.openpgp;
    var options, encrypted;
    var encryptedMsg = document.getElementById('armored-content').innerHTML ;
    
    var armoredmsg = encryptedMsg.replace(/@/g, "\n");
    console.log("armoredmsg:\n" + armoredmsg);
    return openpgp.message.readArmored(armoredmsg).then(function (msg) {
        // console.log("msg " + JSON.stringify(msg));
        console.log("passphrase " + JSON.stringify(passphrase));
        options = {
            message: msg,
            passwords: [passphrase], // decrypt with password
            armor: true,
            format: 'utf8'
        };
        openpgp.decrypt(options).then(function(plaintext) {
            console.log("plaintext of msg " + JSON.stringify(plaintext));
            document.open("text/html", "replace");
            document.write(plaintext.data);
            var meta = document.createElement('meta');
            meta.name = "referrer";
            meta.content = "no-referrer";
            document.getElementsByTagName('head')[0].appendChild(meta);
            document.close();
            return true;
        }).catch(function (error) {
            if (silent) {
                console.log("error: " + error);
            } else {
                var errors = document.getElementById('errors');
                errors.innerHTML = '<b>ERROR: decryption failed: </b><code>'
                    + error
                    + '</code> <i>(usually means wrong password …)</i>';
            };
        });
    });
};
console.log("Setting on submit");
document.getElementById('staticrypt-form').addEventListener('submit', function(e) {
    e.preventDefault();
    console.log("on the submit");
    var passphrase = document.getElementById('staticrypt-password').value;
    console.log("on the submit passph: " + passphrase);
    tryPassphrase(passphrase, false);
});
window.onload = function() { 
    var firstAttempt = "";
    if (window.location.hash.charAt(0) == '#') {
        firstAttempt = window.location.hash.substring(1);
    } else {
        firstAttempt = window.location.hash
    };
    tryPassphrase(firstAttempt, true).then(function(ret) {
        if (ret) {
            console.log("on the else of firstAttempt");
        } else {
            console.log("Nope from the hash: " + firstAttempt);
        };
    }, function(error) {
        console.log("Error from tryPassphrase: " + error);
    });
};
</script>
</body>
</html>
