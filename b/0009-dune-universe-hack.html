<html>
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>
    </style>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/openpgp/4.0.0/openpgp.min.js"
      integrity="sha512-LsI4YA/OY2EMDyHS4lWWUweqqcQXRi5RACGFsemrbqQAguNpNNhjRaJcua7Pvu+SZxGR1vbINmbRM1StWO9Z/Q=="
      crossorigin="anonymous"
    ></script>
</head>
<body>
<h2>PGP-Encrypted Page, please provide a passphrase.</h2>
<form id="staticrypt-form" action="#" method="post">
   <input id="staticrypt-password"
          type="password"
          name="password"
          placeholder="passphrase"
          autofocus/>
   <input id="staticrypt-form-submit"
          type="submit"
          value="DECRYPT"/>
</form>
<div id="errors"></div>
<code><pre id="armored-content">
-----BEGIN PGP MESSAGE-----

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
UltJ
=I1SM
-----END PGP MESSAGE-----
</pre></code>
<script>

function tryPassphrase(passphrase,silent) {
    console.log("tryPassphrase " + passphrase);
    var openpgp = window.openpgp;
    var options, encrypted;
    var encryptedMsg = document.getElementById('armored-content').innerHTML ;
    
    var armoredmsg = encryptedMsg.replace(/@/g, "\n");
    console.log("armoredmsg:\n" + armoredmsg);
    return openpgp.message.readArmored(armoredmsg).then(function (msg) {
        // console.log("msg " + JSON.stringify(msg));
        console.log("passphrase " + JSON.stringify(passphrase));
        options = {
            message: msg,
            passwords: [passphrase], // decrypt with password
            armor: true,
            format: 'utf8'
        };
        openpgp.decrypt(options).then(function(plaintext) {
            console.log("plaintext of msg " + JSON.stringify(plaintext));
            document.open("text/html", "replace");
            document.write(plaintext.data);
            var meta = document.createElement('meta');
            meta.name = "referrer";
            meta.content = "no-referrer";
            document.getElementsByTagName('head')[0].appendChild(meta);
            document.close();
            return true;
        }).catch(function (error) {
            if (silent) {
                console.log("error: " + error);
            } else {
                var errors = document.getElementById('errors');
                errors.innerHTML = '<b>ERROR: decryption failed: </b><code>'
                    + error
                    + '</code> <i>(usually means wrong password …)</i>';
            };
        });
    });
};
console.log("Setting on submit");
document.getElementById('staticrypt-form').addEventListener('submit', function(e) {
    e.preventDefault();
    console.log("on the submit");
    var passphrase = document.getElementById('staticrypt-password').value;
    console.log("on the submit passph: " + passphrase);
    tryPassphrase(passphrase, false);
});
window.onload = function() { 
    var firstAttempt = "";
    if (window.location.hash.charAt(0) == '#') {
        firstAttempt = window.location.hash.substring(1);
    } else {
        firstAttempt = window.location.hash
    };
    tryPassphrase(firstAttempt, true).then(function(ret) {
        if (ret) {
            console.log("on the else of firstAttempt");
        } else {
            console.log("Nope from the hash: " + firstAttempt);
        };
    }, function(error) {
        console.log("Error from tryPassphrase: " + error);
    });
};
</script>
</body>
</html>
