<html>
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>
    </style>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/openpgp/4.0.0/openpgp.min.js"
    ></script>
</head>
<body>
<h2>PGP-Encrypted Page, please provide a passphrase.</h2>
<form id="staticrypt-form" action="#" method="post">
   <input id="staticrypt-password"
          type="password"
          name="password"
          placeholder="passphrase"
          autofocus/>
   <input id="staticrypt-form-submit"
          type="submit"
          value="DECRYPT"/>
</form>
<div id="errors"></div>
<code><pre id="armored-content">
-----BEGIN PGP MESSAGE-----

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
p4IgQ7v2W+ehAmWCNIaHDqNEBEFhoQU=
=cMej
-----END PGP MESSAGE-----
</pre></code>
<script>

function tryPassphrase(passphrase,silent) {
    console.log("tryPassphrase " + passphrase);
    var openpgp = window.openpgp;
    var options, encrypted;
    var encryptedMsg = document.getElementById('armored-content').innerHTML ;
    
    var armoredmsg = encryptedMsg.replace(/@/g, "\n");
    console.log("armoredmsg:\n" + armoredmsg);
    return openpgp.message.readArmored(armoredmsg).then(function (msg) {
        // console.log("msg " + JSON.stringify(msg));
        console.log("passphrase " + JSON.stringify(passphrase));
        options = {
            message: msg,
            passwords: [passphrase], // decrypt with password
            armor: true,
            format: 'utf8'
        };
        openpgp.decrypt(options).then(function(plaintext) {
            console.log("plaintext of msg " + JSON.stringify(plaintext));
            document.open("text/html", "replace");
            document.write(plaintext.data);
            document.close();
            return true;
        }).catch(function (error) {
            if (silent) {
                console.log("error: " + error);
            } else {
                var errors = document.getElementById('errors');
                errors.innerHTML = '<b>ERROR: decryption failed: </b><code>'
                    + error
                    + '</code> <i>(usually means wrong password …)</i>';
            };
        });
    });
};
console.log("Setting on submit");
document.getElementById('staticrypt-form').addEventListener('submit', function(e) {
    e.preventDefault();
    console.log("on the submit");
    var passphrase = document.getElementById('staticrypt-password').value;
    console.log("on the submit passph: " + passphrase);
    tryPassphrase(passphrase, false);
});
window.onload = function() { 
    var firstAttempt = "";
    if (window.location.hash.charAt(0) == '#') {
        firstAttempt = window.location.hash.substring(1);
    } else {
        firstAttempt = window.location.hash
    };
    tryPassphrase(firstAttempt, true).then(function(ret) {
        if (ret) {
            console.log("on the else of firstAttempt");
        } else {
            console.log("Nope from the hash: " + firstAttempt);
        };
    }, function(error) {
        console.log("Error from tryPassphrase: " + error);
    });
};
</script>
</body>
</html>
