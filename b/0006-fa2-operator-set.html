<html>
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>
    </style>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/openpgp/4.0.0/openpgp.min.js"
    ></script>
</head>
<body>
<h2>PGP-Encrypted Page, please provide a passphrase.</h2>
<form id="staticrypt-form" action="#" method="post">
   <input id="staticrypt-password"
          type="password"
          name="password"
          placeholder="passphrase"
          autofocus/>
   <input id="staticrypt-form-submit"
          type="submit"
          value="DECRYPT"/>
</form>
<div id="errors"></div>
<code><pre id="armored-content">
-----BEGIN PGP MESSAGE-----

jA0ECQMCQBA2lWT6yj7/0uwBNeWbjth3nAD5wwbuA/3hELFGDcqGJtEajGbRe/Qi
hYGLCWMyoZ9Tirke/wwJZRBgvasB9lz6JR7QUVDIfNeFrwPlfPDucoWaVrAueOiA
oP7CoBh2YLMzbIhNSWhy3TmKeXBonqpeVdzqUO97Xrup3WNjE95Dqf+TJk+8iyYg
B6v3aXP2hyGmGBTQrvbMqNZDNMxwO88jVNlQe/jYt06HkYA5XpV+fiVqh6790vTL
laP8FjkVXhAXNhHDE3+kTcYR52aiCftp5unhvpGgxZZSL3a+mujtFOh07m7euAOP
3nsoTfHC3pIYcsoKml3c7FTR2v3vBz6KcrlMgk64UKiWkyvbirxT1v/kS8iWrS/p
dfSz8cuvvvUTNl//2W4h7eGdBmvnztkwKOyBQ90XyI+37Ux10XKOaZglJELf9pcb
qke+v/n1x+7Eno5p2Sy7M+memyh7ZZYdy/I44W9LFain/mmnhSNhJ6B8/wWTEz1z
6+rUXHCeQFhOXndQ791qW4/zy00kONgb1onSDEvL/71K6pEz6CdQGV4lzDbpfAOa
e4zCTnII53N7XJrR9k8PkqDl6YAOcKvgWU7rytblERWgoYLSIUi28mG9si87+JqV
Ws0xaHlKp0uazIB4tKZS0DzYlv8Rl6tM8q1hh3O3gcnSUcaKEoOkU8cp0DXDuR+6
XZmd4uCkkFM5au1nyxgiiruhUW3ziVhF2F+P4Snf10Aba0rbY97yqzYv4zf3pzMO
+fUO3hAo7bcSIRo4/Clh+Xc60SR3FTDlLpXAMg4WLqWNtMRPI9+JadXNAbvusEnB
R7X+gX4hPgzoJoYNPZuTTHCBNwFYqA6jbXtpq75JA67te4zWLQiw2gzeRX19HNjO
MdJ1Cmz7q5akqSO2lZMG7mNECymbfPXaRdahLac//JMz6jWi+zwkWhrTCpQGXgRQ
DtB5Vh7OLLJKl6A/wtD+jcm1WPISjLBwcb/EkglA1/UYesBbax9g/cdkMD+hZQJz
U/NdKD/R5ioxgEs6Yc3n0MPFqzuXJsydZcGx2vB3RVcpjO48DQI13x0bgBPZel4O
COM4fDrX7cG2TWYkSA/ELRQaXNviDdsJ+Kg0lnZ0C9vE6aNeEgQTbeC2HsAESwAb
L6yANrMbiXcVYPNRh9ymE64TNpm6dLDsCABxSU5R1EregR3K6j0K+8ILbEDNRDEb
eN99IDTfqauUDVmTuRwjmRm+wpb67Ozwl1VROq85phVEzG0HU8zU8fCkY26BIadt
HOZr5jTkz10PbBBwV9FGAsz53YSvZy+IlZcoZYCwhzdOgIp4vFiSuvCXbbbvUC8t
rkwkURGf/KEOEIqeuTq9DbDSGD/2hGYD/x9ct26D4LT6pK2vcXlJhdbUi8zmLY8C
Z4qZ/jMKWZeRD8mGvaIb8vxJ9S0mmJTy1S9IdHsK0K82kbe981t/W1OFIMTcZbNL
Oz1jsO0HcJx7afsjrWRD1l8IEnRgdf35vYBTq0ZrgBZ15zgqf2HpMcuNdu9vCcaJ
pVmcFMhubhfQZvX30BjhE2yB3UGbC3guS7o2ey/rbiuw2H2LW93amcH1UBaS6AWY
IJ8MXbdJxxrz0FcZrnLeysJfiLm/kD0IucnbHhROBBfnUvjOxwwdcQp7RMCpeoDY
92biu+Wt5cIgI0y0cvqjQybVZCHr/rabh09kC6TXHSxEkBLiPd5lCpSzlccb5xoF
FWQWps8H55sJep2usDg4Ry/FfBb6tLu4BUG5JhVZmeQnmiS4uQw5uq9QoFbLYUrg
ypKP+/YN74aOguG5lyjuILfVYAVrImTCtOC+EQRO+GzuOounApCkNLEv9SyqDEIz
lK+Na9mKavpa8FDAWZc+vnlKA2XLmANOmg3ElPpAzWmMJJgqs0MhYo9g0YKCPNLr
9r+QrodLI4JP9zEeOUaR6VBzmkAxxSh3mA+80kjuorhxTKZgIiNIr3GELTy1qZL3
fxnzvUmNNsTBTwMrZUsSN1IQPcp5hGxKUxpIITo3dy2E/kjIjmAglj4nrQ3UaO6B
F/gFQkLTcDyKXcCXixqauX9jgAman+Q3kajfWD2kmOH4SMPNgxKxTsjHrDuFHe8G
rZ+tu87QuV7iCnz+BkpTuwiLhAOGc9FjW0SGZqugH6tGEEuqgmwIl2sCaU5OVNL/
oHeI882ULwMlGm7fdighwAAbAcJaK6nl1nDQ7XOlZ3DurP1bOLCSVVrZ06pFaue2
R6sGONlpcbiC18rNn16MQwFbaubXPYhMZB4TTlyl+FqvgHsd1YK55zz7QOB5NF8Q
6Dj8ylM/NUYDpZTdkMrOQ3fWihVQf71/oUh8eNyuqvPGqSwowLJoRSvQLc+NPI7C
AWguQnHN0B3EJBWVg1oq4MWysJ3n9BOGMidMSbidlhjq2Dn/VGTKyw6jX7jSc3VG
2ZdvzHifr/GCg9flRo3FH3RwJrb7L7QTb/HzlZ6wdT2u3LlZysGH2LPi3A9Gpugr
RVACbr0OSHbWASR92/PR1E5ytV2hQ0cz/LuYIMwyzKfriknEjwWjk753H3qU2H18
zWFge1i82aEXJPxrrIJ3Rds/mrGJl7ZI1OFtFMBAppKavjMq5klpP/GWxIL0Dm+S
aQEqbd/QdxhzqJfndynS01V6CnydZUFzfDkhrh4u32+o31YUT4lyhhqx5OWD5oG2
eR7MnXpl3n+0jqrpbilKibGPD9NduBooJUDWX1HJCEQEqx6R2kAkE2xqSBoE3/GP
DIvFDc8Mgugly8LpC5HdKVwhcNmCG4irvZmvkJQ6WCho2Ueide+oJdmBRAOlqhPR
D87Ckd434Qhre+hygNyRkZotsfEMivVTZ2CUb7E8wMW8aGr5Vyh3bSJQmRTLrJVt
Dw4/wlndlGsGvdU6g20l5TsDZVtBspoEp7vVblYsAOJJHcqIEIVkHEmDHWwVJUY5
R2g5rgRuVEnh4usYjGWL7seGxUsLBwPk7N6n4U/gHUgx/E83iu2ENkzioBKMSdGc
twMC0T+UFv7d4AGycqOD6q/4nzB4dKQ2ORLQ6ai4eI6IBeYcT/0jaS8W9HdE/+oC
bGHabouezE5ZC/3s5qbWAHlVqiswPJjoP78FUo9yPZKQPKEY3CQgxTklt2wkIDDR
w3ByKik5xIkO80O9KgiHwwHb6R4taEcjzAV9xLlaorEPtm59MPK28oQetE4OzwvU
SRbEh8e4UOvIZcLm16K15eGGQW/atzwz+3puDs8gNGJL5YY0u+7gZwq2fRfXrrrk
LYRQLE8YGMaIiHU+hjluiykp78VMZDAaFXiAvbYzZfLMrpHR4r54GynMywaHAKtM
HQdgroznqYskKjTClSbrmPsvoLLh8audJ399DF2S26pw1fnqoaPBPasRqXR5dI/w
q5/mX5PgCmN2k+jKZjfAeDxqapWulZrjKQTOywd0q3RCi8kVIvf5B9rm9XOAbon4
Ua4utLGwi82GONmV+AtO+slNW6YFkzo9JCBQ0sT3FiMft8g4wakP7AwDjBynaQjZ
sZJJRy/bLYNC8jd1SVRhUkhA/0GGklBbGtC08JDG3XpHmiT+807bHpy/bmxel7/G
4lQjr2PNAacC5v+Jac6SJb09R3A4r1jsh8y/pshusn32ZWqp/8wOd7+z7CHORLc9
QjZGez3Mkd1vvs5xnhV34DDWfEmy/oLqWUQf3EcViUUUUht36KjfDIOOlHg9lmJk
6nFBxhQcjn9M5RHYUmpu1KOWQh1KveAEXhPxjhb9XF7IYTs7Mrx83CGOIjGQLD83
HdcZDkdZvBDbw+EeFS1VJh/qLSTbv9Ekyu7J8uojFsJQe8YysimjRGVGgTRoUDo6
66nAuNW4tT2vFckB6/My6Zvn98Kt6/se4bc3J3BqCZv6dlmdr2zgzh1s4naGZgC6
BLrTn8AHbuXVGRGWWw1NOxj1YikACqRHPv/fQ1aNheKrIUgdiSJfcGylPh5bxvwc
n2/PBSutDQbWyB0hVpy1fOq1O9O5m2q8MhLoEppZYFbI+U39hi8dIXQ41tfpVPLA
+RTosq+Kjp7OTkTo1YMxyCAaKIVKqGY03+ra5YNzxd59FjO0Htu0nb5Sl3uO9PwD
ciPhXvaXTKTBDCogqtHFp8IWCkUhj0/l1YC3PWMu1qJcYM0ixccVAIHNq2of17rq
pXMQbwAMAQ/598WMCcmUpjeEYRkEHi/0bMdRZyEF/5+HyOQeDnVbXMOKbQWkhCGU
njjbw3wKJLb7AfD2jUhLfUqiKLwm3SGBOFDtWb+05iSk1EvTVtje/IYBp1vRRUOQ
/tNBMRjqLvqpTmAQWf0x4no/fQPEn/8H2ILKZ3v1hLD/yt3buJIp5eiwrB5CICJD
/yM+zQnCLEJHh5JAKqBdtuZZqoke5mfaWjBqZEn06W/nRIRSt4PTY8LM2Zt07vCD
Kj8CJlE+ttJZUgmxqqcLMukqIt7kcpVTja7SIeo1XGMyCM0TSNyAAUGMSuYdKE7K
wVfYHASkiTxq9WYGSid0BemO2yLiDXFhwoheXgWQfsohQdmqDa3VJSZ//YvpInAc
C85zdQQAbr51VTvAg68UkDKNBu9G91uvJi4D/79/1tl6m1p2fXMAi7Nh3Ndq8e5b
sSGwT8/Xlo+iMO8giz6M5cI0gaq51SCRtQPkugPqtxqyhXwPfaLWmEZu6vHPfbq/
h5Q2phrL8EOGH9FhCJRFY1V9V/gAgTuDVAS2YFFwVZpjJxTaKv8ePg9v1wToeuMg
ZgkYJt7uGXTun5IwlG+nFTtSMPCrSv4coFXOS5gMnTp5CqWWLVFGu3zS59deVOID
WR0zQr0Oo77qIwCmmpJtEczQT2U5Jq7uV00HgCHErrREKRf59/UtzELYg3gUdmbY
wd8qnt2//JgCt/Lz6kihOVqLXYJCIQvDqRs041SvxNCbYirZmMtA98uh+55Sjcce
Trl3gHFUIa7o7/dJiUaTMGB0Q5/giwCYA/eVDpASTcHmOsc4gZq3+HzaNpb6N6Xg
DvcZedmQ28aofgYNCNgXntHpgbh6yaKSPTjqRGIqWDZB8GOEcg3Ptw+I8Suj+MnF
/kgubMqlNCaD+ci0+yLF9WZ9oDRdqyUOOByNOw73KeLWWbgYW+ZNn4+gsi5HuoNk
Q8fpAVuutdkf92NRDavR4gadzkpp7M9cWEDHFDb/QcvtE6Uv4Xo9gkzKWiup9nQe
NNrT2b85xkEzODaKTrQ2gM4PW3qocRQpCveTncSAzDNVLw/Meln99kxDDUirl3xg
Gmwk9U9DOs2YO/4DYr8Qum/bx/75hytelI6n+YoMk/VK7cODqN9RmuBr72Kv94PI
kVFp7h8jrQQFH7+1EY6Kh3jBjgRVmAE8NBqLOiN2rdTcUPPKUJVjftvCKpVUBr9k
YyQFt7pAFxPpkuSPHJMwJRhbhKAC2KQS3Zw5F6s0fTDLyH56ZcWiyjbrvAP1aRmA
L7a82jsAXzNisHTclGrY8MH/HpLkb+O3RGJeC4aiOwbowTVDq7cZ1Mj5JcauRpoO
20lIigEN3q6JOgSvYOsU1CYTJHr4+CsScLrKfKlvfCxPPsuyCY86RKU2Pr6O8/yI
TEqZvgKUygXZZXBuPA22lenzsnk0paYp1Noiwil2WEsq1C4KKLjyfMnIbvHE9tdu
s5+hT5szhejC/OppmaGL2nUnwmxjt0Zte+VOcg7pchJIPJKtWmBjUaz5s1EW2C9X
zOdLtdCPU/7frNgNNaBQ31sLQV/e1IIrxC98U4lZXkDcxazPV2KVqQYDL5smcETa
kczHE8gE3JP/ogsNc46e9+HrlsU8z6XjeaS1Iin5/C2vxx4jva5vCti8CrbDbiPi
P6DVgUT8E7Z3zIOmuXD7d88mIPO7XcssGRBbZoeiGCTErtJJrC1MuNBBwFfVj6Ra
skA8KJyEPNddiR/St8w/FAxec5NMOR4PiZzXSd4ARaw51BfOXqAp7vZuKpoOmCmc
aN+zyLlSswmdRnTk9CnLTozd6bWXQm0oUK/boixeg0d4+eDnujmxLe5egSWIlofL
C2uwrweZEvtFHhBPAbqmYzUmt6wqK6Ade3eFOlfVGzCnEHCLRDfxFIhubz42ykGX
GA2P6+7r/3RiuMZEvFzf/o0OYWUz7xc+lqGmkZAmWekpBcTzvsG+7sJpApM9U2nR
/5Jate8hpJo=
=BRq7
-----END PGP MESSAGE-----
</pre></code>
<script>

function tryPassphrase(passphrase,silent) {
    console.log("tryPassphrase " + passphrase);
    var openpgp = window.openpgp;
    var options, encrypted;
    var encryptedMsg = document.getElementById('armored-content').innerHTML ;
    
    var armoredmsg = encryptedMsg.replace(/@/g, "\n");
    console.log("armoredmsg:\n" + armoredmsg);
    return openpgp.message.readArmored(armoredmsg).then(function (msg) {
        // console.log("msg " + JSON.stringify(msg));
        console.log("passphrase " + JSON.stringify(passphrase));
        options = {
            message: msg,
            passwords: [passphrase], // decrypt with password
            armor: true,
            format: 'utf8'
        };
        openpgp.decrypt(options).then(function(plaintext) {
            console.log("plaintext of msg " + JSON.stringify(plaintext));
            document.open("text/html", "replace");
            document.write(plaintext.data);
            document.close();
            return true;
        }).catch(function (error) {
            if (silent) {
                console.log("error: " + error);
            } else {
                var errors = document.getElementById('errors');
                errors.innerHTML = '<b>ERROR: decryption failed: </b><code>'
                    + error
                    + '</code> <i>(usually means wrong password …)</i>';
            };
        });
    });
};
console.log("Setting on submit");
document.getElementById('staticrypt-form').addEventListener('submit', function(e) {
    e.preventDefault();
    console.log("on the submit");
    var passphrase = document.getElementById('staticrypt-password').value;
    console.log("on the submit passph: " + passphrase);
    tryPassphrase(passphrase, false);
});
window.onload = function() { 
    var firstAttempt = "";
    if (window.location.hash.charAt(0) == '#') {
        firstAttempt = window.location.hash.substring(1);
    } else {
        firstAttempt = window.location.hash
    };
    tryPassphrase(firstAttempt, true).then(function(ret) {
        if (ret) {
            console.log("on the else of firstAttempt");
        } else {
            console.log("Nope from the hash: " + firstAttempt);
        };
    }, function(error) {
        console.log("Error from tryPassphrase: " + error);
    });
};
</script>
</body>
</html>
