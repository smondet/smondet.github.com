<html>
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>
    </style>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/openpgp/4.0.0/openpgp.min.js"
    ></script>
</head>
<body>
<h2>PGP-Encrypted Page, please provide a passphrase.</h2>
<form id="staticrypt-form" action="#" method="post">
   <input id="staticrypt-password"
          type="password"
          name="password"
          placeholder="passphrase"
          autofocus/>
   <input id="staticrypt-form-submit"
          type="submit"
          value="DECRYPT"/>
</form>
<div id="errors"></div>
<code><pre id="armored-content">
-----BEGIN PGP MESSAGE-----

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
yULAC6CTArJnjqqgx3hlSVnt
=dgeQ
-----END PGP MESSAGE-----
</pre></code>
<script>

function tryPassphrase(passphrase,silent) {
    console.log("tryPassphrase " + passphrase);
    var openpgp = window.openpgp;
    var options, encrypted;
    var encryptedMsg = document.getElementById('armored-content').innerHTML ;
    
    var armoredmsg = encryptedMsg.replace(/@/g, "\n");
    console.log("armoredmsg:\n" + armoredmsg);
    return openpgp.message.readArmored(armoredmsg).then(function (msg) {
        // console.log("msg " + JSON.stringify(msg));
        console.log("passphrase " + JSON.stringify(passphrase));
        options = {
            message: msg,
            passwords: [passphrase], // decrypt with password
            armor: true,
            format: 'utf8'
        };
        openpgp.decrypt(options).then(function(plaintext) {
            console.log("plaintext of msg " + JSON.stringify(plaintext));
            document.open("text/html", "replace");
            document.write(plaintext.data);
            document.close();
            return true;
        }).catch(function (error) {
            if (silent) {
                console.log("error: " + error);
            } else {
                var errors = document.getElementById('errors');
                errors.innerHTML = '<b>ERROR: decryption failed: </b><code>'
                    + error
                    + '</code> <i>(usually means wrong password …)</i>';
            };
        });
    });
};
console.log("Setting on submit");
document.getElementById('staticrypt-form').addEventListener('submit', function(e) {
    e.preventDefault();
    console.log("on the submit");
    var passphrase = document.getElementById('staticrypt-password').value;
    console.log("on the submit passph: " + passphrase);
    tryPassphrase(passphrase, false);
});
window.onload = function() { 
    var firstAttempt = "";
    if (window.location.hash.charAt(0) == '#') {
        firstAttempt = window.location.hash.substring(1);
    } else {
        firstAttempt = window.location.hash
    };
    tryPassphrase(firstAttempt, true).then(function(ret) {
        if (ret) {
            console.log("on the else of firstAttempt");
        } else {
            console.log("Nope from the hash: " + firstAttempt);
        };
    }, function(error) {
        console.log("Error from tryPassphrase: " + error);
    });
};
</script>
</body>
</html>
